<!DOCTYPE html>
<html lang="en">
<html>

<head>
  <meta charset="UTF-8">
  <link href="/.static/css/primer.css" rel="stylesheet" />
  <link rel="stylesheet alternate" href="/.static/css/github-light.css" id="light-hl">
  <link rel="stylesheet alternate" href="/.static/css/github-dark.css" id="dark-hl">
  <link rel="stylesheet" href="/.static/css/main.css">
  <title>设计模式.md</title>
</head>

<body id="markdown-body" data-color-mode="light" data-dark-theme="light">
  <!-- <div class="
  Box
  md
  js-code-block-container
  Box--responsive
  container-nav
  container-left-nav
  mt-5
  d-none d-lg-block
">
    <div class="Box-body p-5">
      <div class="d-flex flex-column flex-sm-row-reverse">
        <h1>填充...</h1>
      </div>
    </div>
    <div>填充</div>
  </div> -->
  <div class="
        Box
        md
        js-code-block-container
        Box--responsive
        container-xl
        px-3 px-md-4 px-lg-5
        mt-5
      " id="content">
    <div class="Box-body px-5 pb-5">
      <div class="d-flex flex-column flex-sm-row-reverse">
        <div class="border rounded-3 to-home">
          <a href="/">返回主页</a>
        </div>
        <div>
          <button id="theme-button" class="btn" type="button">
            <span id="theme-icon" class="iconify" data-icon="octicon:sun-16"></span>
          </button>
        </div>
        <div class="article-size">
          <span>3645字 | 9分钟</span>
        </div>
      </div>
      <article class="markdown-body entry-content container-lg" itemprop="text">
        <h2><a id="user-content-零面向对象设计原则" class="anchor" aria-hidden="true" tabindex="-1" href="#零面向对象设计原则"><span aria-hidden="true" class="octicon octicon-link"></span></a>零、面向对象设计原则</h2>
<h3><a id="user-content-1-单一原则" class="anchor" aria-hidden="true" tabindex="-1" href="#1-单一原则"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 单一原则</h3>
<p>单一的类，实现单一的职责</p>
<h3><a id="user-content-2-开闭原则" class="anchor" aria-hidden="true" tabindex="-1" href="#2-开闭原则"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 开闭原则</h3>
<p>对扩展开放，对修改关闭</p>
<h3><a id="user-content-3-里氏代换原则" class="anchor" aria-hidden="true" tabindex="-1" href="#3-里氏代换原则"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 里氏代换原则</h3>
<p>不要破坏继承体系，父类对象出现的地方都可以使用子类对象替换，而程序的执行结果不变。</p>
<h3><a id="user-content-4-依赖倒转原则" class="anchor" aria-hidden="true" tabindex="-1" href="#4-依赖倒转原则"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. 依赖倒转原则</h3>
<p>抽象不应该依赖细节，细节应该依赖于抽象。</p>
<h3><a id="user-content-5-接口隔离原则" class="anchor" aria-hidden="true" tabindex="-1" href="#5-接口隔离原则"><span aria-hidden="true" class="octicon octicon-link"></span></a>5. 接口隔离原则</h3>
<p>接口设计要精简单一，类间的依赖关系应该建立在最小的接口上。</p>
<h3><a id="user-content-6-迪米特法则" class="anchor" aria-hidden="true" tabindex="-1" href="#6-迪米特法则"><span aria-hidden="true" class="octicon octicon-link"></span></a>6. 迪米特法则</h3>
<p>降低耦合, 一个类应该尽量少的了解其它类的信息</p>
<h3><a id="user-content-7-组合聚合复用原则" class="anchor" aria-hidden="true" tabindex="-1" href="#7-组合聚合复用原则"><span aria-hidden="true" class="octicon octicon-link"></span></a>7. 组合/聚合复用原则</h3>
<p>聚合表示整体与部分的关系，表示"含有"，整体由部分组合而成，部分可以脱离整体作为一个独立的个体存在。组合则是一种更强的聚合，部分组成整体，而且不可分割，部分不能脱离整体而单独存在。</p>
<ul>
<li>子类是超类的一个特殊种类，而不是超类的一个角色，也就是区分"Has-A"和"Is-A".只有"Is-A"关系才符合继承关系，"Has-A"关系应当使用聚合来描述。</li>
<li>永远不会出现需要将子类换成另外一个类的子类的情况。如果不能肯定将来是否会变成另外一个子类的话，就不要使用继承。</li>
<li>子类具有扩展超类的责任，而不是具有置换掉或注销掉超类的责任。如果一个子类需要大量的置换掉超类的行为，那么这个类就不应该是这个超类的子类。</li>
</ul>
<h2><a id="user-content-一创建型模式-介绍对象创建" class="anchor" aria-hidden="true" tabindex="-1" href="#一创建型模式-介绍对象创建"><span aria-hidden="true" class="octicon octicon-link"></span></a>一、创建型模式-&gt;介绍对象创建</h2>
<h3><a id="user-content-1-工厂模式" class="anchor" aria-hidden="true" tabindex="-1" href="#1-工厂模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 工厂模式</h3>
<blockquote>
<p>两种模式可以用于以下场景</p>
<p>a. 追踪对象的创建</p>
<p>b. 对象的创建与使用进行解耦</p>
<p>c. 优化应用的性能和资源占用</p>
</blockquote>
<p>1.1 工厂方法</p>
<blockquote>
<p><strong>工厂方法设计模式负责单一一种类对象的创建</strong></p>
<p><strong>通过不同的输入参数获得不同的连接对象</strong></p>
</blockquote>
<p>在日常开发中，我们多数情况下是需要和数据库进行交互的，那我们就可以使用工厂方法对数据库的交互进行处理！在下方的例子中，我们可能会有三种数据库进行连接<code>MySQL</code>,<code>PgSQL</code>,<code>SQLServer</code>。那么我们在连接数据库部分加入一个工厂方法，用户通过不同的输入参数获得不同的连接对象。</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/factory_factory.py</span>
<span class="pl-k">from</span> <span class="pl-s1">abc</span> <span class="pl-k">import</span> <span class="pl-v">ABCMeta</span>, <span class="pl-s1">abstractmethod</span>


<span class="pl-k">class</span> <span class="pl-v">ConnectError</span>(<span class="pl-v">Exception</span>):
    <span class="pl-k">pass</span>


<span class="pl-k">class</span> <span class="pl-v">ConnectFactory</span>(<span class="pl-s1">metaclass</span><span class="pl-c1">=</span><span class="pl-v">ABCMeta</span>):

    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">raise</span>


<span class="pl-k">class</span> <span class="pl-v">MySQLConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"MySQL连接obj"</span>


<span class="pl-k">class</span> <span class="pl-v">PgSQLConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"PgSQL连接obj"</span>


<span class="pl-k">class</span> <span class="pl-v">SQLServerConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"SQLServer连接obj"</span>


<span class="pl-k">def</span> <span class="pl-en">connect_factory</span>(<span class="pl-s1">db_type</span>):

    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"MySQL"</span>:
        <span class="pl-k">return</span> <span class="pl-v">MySQLConnect</span>()
    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"PgSQL"</span>:
        <span class="pl-k">return</span> <span class="pl-v">PgSQLConnect</span>()
    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"SQLServer"</span>:
        <span class="pl-k">return</span> <span class="pl-v">SQLServerConnect</span>()

    <span class="pl-k">raise</span> <span class="pl-v">ConnectError</span>(<span class="pl-s">"数据库连接异常"</span>)


<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-s1">conn</span> <span class="pl-c1">=</span> <span class="pl-en">connect_factory</span>(<span class="pl-s">"MySQL"</span>)
    <span class="pl-en">print</span>(<span class="pl-s1">conn</span>.<span class="pl-en">connect</span>())
    <span class="pl-s1">conn</span> <span class="pl-c1">=</span> <span class="pl-en">connect_factory</span>(<span class="pl-s">"PgSQL"</span>)
    <span class="pl-en">print</span>(<span class="pl-s1">conn</span>.<span class="pl-en">connect</span>())
    <span class="pl-s1">conn</span> <span class="pl-c1">=</span> <span class="pl-en">connect_factory</span>(<span class="pl-s">"SQLServer"</span>)
    <span class="pl-en">print</span>(<span class="pl-s1">conn</span>.<span class="pl-en">connect</span>())
    <span class="pl-s1">conn</span> <span class="pl-c1">=</span> <span class="pl-en">connect_factory</span>(<span class="pl-s">"redis"</span>)
    <span class="pl-en">print</span>(<span class="pl-s1">conn</span>.<span class="pl-en">connect</span>())</pre></div>
<p>1.2 抽象工厂</p>
<blockquote>
<p><strong>可以理解为是工厂方法的工厂方法，源于工厂方法，本质还是实现同属一种种类的诸多工厂方法的工厂方法</strong></p>
<p><strong>抽象工厂模式是抽象方法的一种泛化，可以理解为它是一组工厂方法</strong></p>
</blockquote>
<p>在下面的例子中，我们将模拟一个数据库存储服务商，我们有一堆数据库服务，同时我们有两个简单工厂，分别帮助咱们创建两种不同费用的数据库实例给到客户端。当然，我们还有一个抽象工厂模型。在这里需要客户端告知我们他将为这个服务付费多少以及需要的数据库实例类型，我们将通过中抽象模型进行数据库实例的建立及分发。</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/abstract_factory.py</span>
<span class="pl-k">from</span> <span class="pl-s1">abc</span> <span class="pl-k">import</span> <span class="pl-v">ABCMeta</span>, <span class="pl-s1">abstractmethod</span>


<span class="pl-k">class</span> <span class="pl-v">ConnectError</span>(<span class="pl-v">Exception</span>):
    <span class="pl-k">pass</span>


<span class="pl-k">class</span> <span class="pl-v">ConnectFactory</span>(<span class="pl-s1">metaclass</span><span class="pl-c1">=</span><span class="pl-v">ABCMeta</span>):

    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">raise</span>


<span class="pl-k">class</span> <span class="pl-v">MySQLCommunityConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"MySQL社区版连接obj"</span>


<span class="pl-k">class</span> <span class="pl-v">MySQLEnterpriseConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"MySQL企业版连接obj"</span>


<span class="pl-k">class</span> <span class="pl-v">PgSQLCommunityConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"PgSQL社区版连接obj"</span>


<span class="pl-k">class</span> <span class="pl-v">PgSQLEnterpriseConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"PgSQL企业版连接obj"</span>


<span class="pl-k">class</span> <span class="pl-v">SQLServerCommunityConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"SQLServer社区版连接obj"</span>


<span class="pl-k">class</span> <span class="pl-v">SQLServerEnterpriseConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"SQLServer企业版连接obj"</span>


<span class="pl-k">def</span> <span class="pl-en">connect_community_factory</span>(<span class="pl-s1">db_type</span>):

    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"MySQL"</span>:
        <span class="pl-k">return</span> <span class="pl-v">MySQLCommunityConnect</span>()
    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"PgSQL"</span>:
        <span class="pl-k">return</span> <span class="pl-v">SQLServerCommunityConnect</span>()
    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"SQLServer"</span>:
        <span class="pl-k">return</span> <span class="pl-v">SQLServerCommunityConnect</span>()

    <span class="pl-k">raise</span> <span class="pl-v">ConnectError</span>(<span class="pl-s">"数据库连接异常"</span>)


<span class="pl-k">def</span> <span class="pl-en">connect_enterprise_factory</span>(<span class="pl-s1">db_type</span>):

    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"MySQL"</span>:
        <span class="pl-k">return</span> <span class="pl-v">MySQLEnterpriseConnect</span>()
    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"PgSQL"</span>:
        <span class="pl-k">return</span> <span class="pl-v">SQLServerEnterpriseConnect</span>()
    <span class="pl-k">if</span> <span class="pl-s1">db_type</span> <span class="pl-c1">==</span> <span class="pl-s">"SQLServer"</span>:
        <span class="pl-k">return</span> <span class="pl-v">SQLServerEnterpriseConnect</span>()

    <span class="pl-k">raise</span> <span class="pl-v">ConnectError</span>(<span class="pl-s">"数据库连接异常"</span>)


<span class="pl-c"># 抽象工厂集合</span>
<span class="pl-k">def</span> <span class="pl-en">connect_factory</span>(<span class="pl-s1">price</span>, <span class="pl-s1">db_type</span>):
    <span class="pl-k">if</span> <span class="pl-s1">price</span> <span class="pl-c1">&gt;</span> <span class="pl-c1">0</span>:
        <span class="pl-k">return</span> <span class="pl-en">connect_enterprise_factory</span>(<span class="pl-s1">db_type</span>)
    <span class="pl-k">return</span> <span class="pl-en">connect_community_factory</span>(<span class="pl-s1">db_type</span>)


<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-c"># 通过预算，我们给这个客户端分配不同的数据库服务器</span>
    <span class="pl-s1">conn</span> <span class="pl-c1">=</span> <span class="pl-en">connect_factory</span>(<span class="pl-c1">0</span>, <span class="pl-s">"MySQL"</span>)
    <span class="pl-en">print</span>(<span class="pl-s1">conn</span>.<span class="pl-en">connect</span>())
    <span class="pl-s1">conn</span> <span class="pl-c1">=</span> <span class="pl-en">connect_factory</span>(<span class="pl-c1">100</span>, <span class="pl-s">"PgSQL"</span>)
    <span class="pl-en">print</span>(<span class="pl-s1">conn</span>.<span class="pl-en">connect</span>())
    <span class="pl-s1">conn</span> <span class="pl-c1">=</span> <span class="pl-en">connect_factory</span>(<span class="pl-c1">0</span>, <span class="pl-s">"SQLServer"</span>)
    <span class="pl-en">print</span>(<span class="pl-s1">conn</span>.<span class="pl-en">connect</span>())</pre></div>
<h3><a id="user-content-2-建造者模式" class="anchor" aria-hidden="true" tabindex="-1" href="#2-建造者模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 建造者模式</h3>
<blockquote>
<p>该模式在以下场景较为适用</p>
<p>a. 若您需要创建一个复杂对象(多步骤，步骤之间还有一定顺序)</p>
<p>b. 一个对象有不同的表现，希望将对象的构造(这里可以理解为初始传参)和表现解耦</p>
</blockquote>
<blockquote>
<p><strong>该模式中，有两个参与者：建造者builder和指挥者director。建造者负责复杂对象的各个组成部分</strong></p>
<p><strong>建造者可能需要多个步骤来完成对象的创建</strong></p>
</blockquote>
<p>在下面的例子中，我们模拟了一个客户端获取数据库实例对象的过程。整个过程中，客户端只需要告诉我们他需要哪一家的云服务器就可以了，对于指挥者director而言，他需要监督建造者builder按照一定的流程进行建造。而建造者亦是按照一定的规范去设置建造过程中的内容，一步步的完成构建工作。客户端的操作变得及其简单化。思路回过头来，我们这里是建造者模式，不过也是创建型的一种，目的就是为了创建对象，在这里我们可以很清楚的感受到创建对象的过程变得简单多了。</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/factory_builder.py</span>
<span class="pl-k">from</span> <span class="pl-s1">abc</span> <span class="pl-k">import</span> <span class="pl-v">ABCMeta</span>, <span class="pl-s1">abstractmethod</span>


<span class="pl-k">class</span> <span class="pl-v">ConnectFactory</span>(<span class="pl-s1">metaclass</span><span class="pl-c1">=</span><span class="pl-v">ABCMeta</span>):

    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">raise</span>


<span class="pl-k">class</span> <span class="pl-v">MySQLEnterpriseConnect</span>(<span class="pl-v">ConnectFactory</span>):

    <span class="pl-k">def</span> <span class="pl-en">connect</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"MySQL企业版连接obj"</span>


<span class="pl-c"># 约束建造者</span>
<span class="pl-k">class</span> <span class="pl-v">Builder</span>(<span class="pl-s1">metaclass</span><span class="pl-c1">=</span><span class="pl-v">ABCMeta</span>):

    <span class="pl-c"># 帮客户购买机器</span>
    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">buy</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">raise</span>

    <span class="pl-c"># 帮客户开机</span>
    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">open</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">raise</span>

    <span class="pl-c"># 帮客户设置机器磁盘大小</span>
    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">disk</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">raise</span>

    <span class="pl-c"># 帮客户安装数据库软件</span>
    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">install</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">raise</span>

    <span class="pl-c"># 客户获取数据库实例</span>
    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">db</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">raise</span>


<span class="pl-k">class</span> <span class="pl-v">BaseBuilder</span>(<span class="pl-v">Builder</span>):

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">_name</span> <span class="pl-c1">=</span> <span class="pl-s">"客服"</span>

    <span class="pl-k">def</span> <span class="pl-en">buy</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">_name</span><span class="pl-kos">}</span></span>帮助客户下单了一台数据库服务器"</span>)

    <span class="pl-k">def</span> <span class="pl-en">open</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">_name</span><span class="pl-kos">}</span></span>将服务器进行了开机"</span>)

    <span class="pl-k">def</span> <span class="pl-en">disk</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">_name</span><span class="pl-kos">}</span></span>将服务器设置为40GB"</span>)

    <span class="pl-k">def</span> <span class="pl-en">install</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">_name</span><span class="pl-kos">}</span></span>将数据库安装进入了服务器"</span>)

    <span class="pl-k">def</span> <span class="pl-en">db</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-v">MySQLEnterpriseConnect</span>().<span class="pl-en">connect</span>()


<span class="pl-k">class</span> <span class="pl-v">Alibuilder</span>(<span class="pl-v">BaseBuilder</span>):

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">_name</span> <span class="pl-c1">=</span> <span class="pl-s">"阿里云客服"</span>

    <span class="pl-k">def</span> <span class="pl-en">disk</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">_name</span><span class="pl-kos">}</span></span>将服务器设置为38GB"</span>)


<span class="pl-k">class</span> <span class="pl-v">Huaweibuilder</span>(<span class="pl-v">BaseBuilder</span>):

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">_name</span> <span class="pl-c1">=</span> <span class="pl-s">"华为云客服"</span>

    <span class="pl-k">def</span> <span class="pl-en">disk</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">_name</span><span class="pl-kos">}</span></span>将服务器设置为39GB"</span>)


<span class="pl-k">class</span> <span class="pl-v">DBDirector</span>():
    <span class="pl-c"># 数据库指挥者</span>
    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">builder</span> <span class="pl-c1">=</span> <span class="pl-c1">None</span>

    <span class="pl-k">def</span> <span class="pl-en">construct_builder</span>(<span class="pl-s1">self</span>, <span class="pl-s1">builder</span>: <span class="pl-v">Builder</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">builder</span> <span class="pl-c1">=</span> <span class="pl-s1">builder</span>
        <span class="pl-s1">self</span>.<span class="pl-s1">builder</span>.<span class="pl-en">buy</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">builder</span>.<span class="pl-en">open</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">builder</span>.<span class="pl-en">disk</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">builder</span>.<span class="pl-en">install</span>()

    <span class="pl-k">def</span> <span class="pl-en">db</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s1">self</span>.<span class="pl-s1">builder</span>.<span class="pl-en">db</span>()


<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-c"># user_choice = "alibuilder"</span>
    <span class="pl-s1">user_choice</span> <span class="pl-c1">=</span> <span class="pl-s">"huaweibuilder"</span>
    <span class="pl-k">if</span> <span class="pl-s1">user_choice</span> <span class="pl-c1">==</span> <span class="pl-s">"alibuilder"</span>:
        <span class="pl-s1">builder</span> <span class="pl-c1">=</span> <span class="pl-v">Alibuilder</span>()
    <span class="pl-k">else</span>:
        <span class="pl-s1">builder</span> <span class="pl-c1">=</span> <span class="pl-v">Huaweibuilder</span>()

    <span class="pl-c"># 指挥者指挥建造者进行数据库实例的构建</span>
    <span class="pl-s1">instance</span> <span class="pl-c1">=</span> <span class="pl-v">DBDirector</span>()
    <span class="pl-s1">instance</span>.<span class="pl-en">construct_builder</span>(<span class="pl-s1">builder</span>)
    <span class="pl-s1">conn</span> <span class="pl-c1">=</span> <span class="pl-s1">instance</span>.<span class="pl-en">db</span>()
    <span class="pl-en">print</span>(<span class="pl-s">"客户端获取连接对象:"</span>, <span class="pl-s1">conn</span>)</pre></div>
<h3><a id="user-content-3-原型模式" class="anchor" aria-hidden="true" tabindex="-1" href="#3-原型模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 原型模式</h3>
<blockquote>
<p><strong>该模式中，将帮助我们创建一个对象的克隆</strong></p>
</blockquote>
<p>python语言中，对象的克隆是一个内置的特性，在python中<code>变量就是标签</code>。</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/factory_prototype.py</span>
<span class="pl-k">import</span> <span class="pl-s1">copy</span>


<span class="pl-k">class</span> <span class="pl-v">User</span>():

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>, <span class="pl-s1">id</span>, <span class="pl-s1">name</span>, <span class="pl-s1">age</span>, <span class="pl-s1">gender</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">id</span> <span class="pl-c1">=</span> <span class="pl-s1">id</span>
        <span class="pl-s1">self</span>.<span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s1">name</span>
        <span class="pl-s1">self</span>.<span class="pl-s1">age</span> <span class="pl-c1">=</span> <span class="pl-s1">age</span>
        <span class="pl-s1">self</span>.<span class="pl-s1">gender</span> <span class="pl-c1">=</span> <span class="pl-s1">gender</span>

    <span class="pl-k">def</span> <span class="pl-en">__str__</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s">"%s-%s-%s-%s"</span> <span class="pl-c1">%</span> (<span class="pl-s1">self</span>.<span class="pl-s1">id</span>, <span class="pl-s1">self</span>.<span class="pl-s1">name</span>, <span class="pl-s1">self</span>.<span class="pl-s1">age</span>, <span class="pl-s1">self</span>.<span class="pl-s1">gender</span>)


<span class="pl-k">class</span> <span class="pl-v">Prototype</span>():

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">obj</span> <span class="pl-c1">=</span> <span class="pl-en">dict</span>()

    <span class="pl-k">def</span> <span class="pl-en">register</span>(<span class="pl-s1">self</span>, <span class="pl-s1">identify</span>, <span class="pl-s1">obj</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">obj</span>[<span class="pl-s1">identify</span>] <span class="pl-c1">=</span> <span class="pl-s1">obj</span>

    <span class="pl-k">def</span> <span class="pl-en">unregister</span>(<span class="pl-s1">self</span>, <span class="pl-s1">identify</span>):
        <span class="pl-k">del</span> <span class="pl-s1">self</span>.<span class="pl-s1">obj</span>[<span class="pl-s1">identify</span>]

    <span class="pl-k">def</span> <span class="pl-en">clone</span>(<span class="pl-s1">self</span>, <span class="pl-s1">identify</span>, <span class="pl-c1">**</span><span class="pl-s1">attrs</span>):
        <span class="pl-s1">found_obj</span> <span class="pl-c1">=</span> <span class="pl-s1">self</span>.<span class="pl-s1">obj</span>.<span class="pl-en">get</span>(<span class="pl-s1">identify</span>)
        <span class="pl-k">if</span> <span class="pl-c1">not</span> <span class="pl-s1">found_obj</span>:
            <span class="pl-k">raise</span>
        <span class="pl-s1">obj</span> <span class="pl-c1">=</span> <span class="pl-s1">copy</span>.<span class="pl-en">deepcopy</span>(<span class="pl-s1">found_obj</span>)
        <span class="pl-s1">obj</span>.<span class="pl-s1">__dict__</span>.<span class="pl-en">update</span>(<span class="pl-s1">attrs</span>)
        <span class="pl-k">return</span> <span class="pl-s1">obj</span>


<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-s1">data01</span> <span class="pl-c1">=</span> <span class="pl-v">User</span>(<span class="pl-s">"1"</span>, <span class="pl-s">"张三"</span>, <span class="pl-c1">20</span>, <span class="pl-s">"男"</span>)
    <span class="pl-en">print</span>(<span class="pl-s1">data01</span>)

    <span class="pl-s1">prototype</span> <span class="pl-c1">=</span> <span class="pl-v">Prototype</span>()
    <span class="pl-s1">identify</span> <span class="pl-c1">=</span> <span class="pl-s">"data001"</span>
    <span class="pl-s1">prototype</span>.<span class="pl-en">register</span>(<span class="pl-s1">identify</span>, <span class="pl-s1">data01</span>)
    <span class="pl-s1">data02</span> <span class="pl-c1">=</span> <span class="pl-s1">prototype</span>.<span class="pl-en">clone</span>(<span class="pl-s1">identify</span>, <span class="pl-c1">**</span>{
        <span class="pl-s">"id"</span>: <span class="pl-c1">2</span>,
        <span class="pl-s">"name"</span>: <span class="pl-s">"李四"</span>,
        <span class="pl-s">"age"</span>: <span class="pl-c1">22</span>,
        <span class="pl-s">"gender"</span>: <span class="pl-s">"男"</span>,
    })
    <span class="pl-en">print</span>(<span class="pl-s1">data01</span>, <span class="pl-s1">data02</span>, <span class="pl-en">id</span>(<span class="pl-s1">data01</span>), <span class="pl-en">id</span>(<span class="pl-s1">data02</span>))</pre></div>
<h2><a id="user-content-二结构型模式-介绍不同对象之间的关系" class="anchor" aria-hidden="true" tabindex="-1" href="#二结构型模式-介绍不同对象之间的关系"><span aria-hidden="true" class="octicon octicon-link"></span></a>二、结构型模式-&gt;介绍不同对象之间的关系</h2>
<h3><a id="user-content-1-适配器模式" class="anchor" aria-hidden="true" tabindex="-1" href="#1-适配器模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 适配器模式</h3>
<blockquote>
<p>该模式中，帮助我们实验两个不兼容接口之间的兼容</p>
</blockquote>
<p>比如iPhone手机，国行、港版、美版、欧版手机的充电接口都是<code>Lightning</code>,但是不同区域会有不同的标准，这就导致我们在使用iPhone过程中需要使用不同的充电器来为iPhone供电，为了解决问题，我们可以定义一个适配器为手机充电，例如下面的例子：</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/struct_adapter.py</span>
<span class="pl-k">class</span> <span class="pl-v">Charge</span>:
    <span class="pl-s">"""标准充电器"""</span>

    <span class="pl-k">def</span> <span class="pl-en">start</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"标准充电器, 为iPhone充电中"</span>)
    
<span class="pl-k">class</span> <span class="pl-v">ChineseCharge</span>:
    <span class="pl-s">"""国行充电器"""</span>

    <span class="pl-k">def</span> <span class="pl-en">charge5V</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">"国行5v充电器，为iPhone充电中"</span>)


<span class="pl-k">class</span> <span class="pl-v">OtherCharge</span>:
    <span class="pl-s">"""其他充电器"""</span>

    <span class="pl-k">def</span> <span class="pl-en">super_charge</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">"其他超级快充充电器，为iPhone充电中"</span>)


<span class="pl-k">class</span> <span class="pl-v">AdapterCharge</span>:
    <span class="pl-s">"""转换器，为充电器适配"""</span>
    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>, <span class="pl-s1">charge</span>, <span class="pl-c1">*</span><span class="pl-s1">args</span>, <span class="pl-c1">**</span><span class="pl-s1">kwargs</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">__charge</span> <span class="pl-c1">=</span> <span class="pl-en">charge</span>(<span class="pl-c1">*</span><span class="pl-s1">args</span>, <span class="pl-c1">**</span><span class="pl-s1">kwargs</span>)
        <span class="pl-k">if</span> <span class="pl-en">isinstance</span>(<span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>, <span class="pl-v">Charge</span>):
            <span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>.<span class="pl-s1">do_charge</span> <span class="pl-c1">=</span> <span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>.<span class="pl-s1">start</span>
        <span class="pl-k">if</span> <span class="pl-en">isinstance</span>(<span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>, <span class="pl-v">ChineseCharge</span>):
            <span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>.<span class="pl-s1">do_charge</span> <span class="pl-c1">=</span> <span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>.<span class="pl-s1">charge5V</span>
        <span class="pl-k">if</span> <span class="pl-en">isinstance</span>(<span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>, <span class="pl-v">OtherCharge</span>):
            <span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>.<span class="pl-s1">do_charge</span> <span class="pl-c1">=</span> <span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>.<span class="pl-s1">super_charge</span>
    
    <span class="pl-k">def</span> <span class="pl-en">execute</span>(<span class="pl-s1">self</span>, <span class="pl-c1">*</span><span class="pl-s1">args</span>, <span class="pl-c1">**</span><span class="pl-s1">kwargs</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">__charge</span>.<span class="pl-en">do_charge</span>(<span class="pl-c1">*</span><span class="pl-s1">args</span>, <span class="pl-c1">**</span><span class="pl-s1">kwargs</span>)


<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-s1">adapter1</span> <span class="pl-c1">=</span> <span class="pl-v">AdapterCharge</span>(<span class="pl-v">Charge</span>)
    <span class="pl-s1">adapter1</span>.<span class="pl-en">execute</span>()
    <span class="pl-s1">adapter2</span> <span class="pl-c1">=</span> <span class="pl-v">AdapterCharge</span>(<span class="pl-v">ChineseCharge</span>)
    <span class="pl-s1">adapter2</span>.<span class="pl-en">execute</span>()
    <span class="pl-s1">adapter3</span> <span class="pl-c1">=</span> <span class="pl-v">AdapterCharge</span>(<span class="pl-v">OtherCharge</span>)
    <span class="pl-s1">adapter3</span>.<span class="pl-en">execute</span>()</pre></div>
<h3><a id="user-content-2-修饰器模式" class="anchor" aria-hidden="true" tabindex="-1" href="#2-修饰器模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 修饰器模式</h3>
<blockquote>
<p>该模式中，能够支持动态的扩展对象功能</p>
</blockquote>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/struct_decorator.py</span>
<span class="pl-k">import</span> <span class="pl-s1">time</span>
<span class="pl-k">import</span> <span class="pl-s1">functools</span>

<span class="pl-k">def</span> <span class="pl-en">memoize</span>(<span class="pl-s1">f</span>):
    <span class="pl-s1">cache_dict</span> <span class="pl-c1">=</span> {}
    <span class="pl-en">@<span class="pl-s1">functools</span>.<span class="pl-en">wraps</span>(<span class="pl-s1">f</span>)</span>
    <span class="pl-k">def</span> <span class="pl-en">wrapper</span>(<span class="pl-c1">*</span><span class="pl-s1">args</span>):
        <span class="pl-k">if</span> <span class="pl-s1">args</span> <span class="pl-c1">not</span> <span class="pl-c1">in</span> <span class="pl-s1">cache_dict</span>:
            <span class="pl-s1">cache_dict</span>[<span class="pl-s1">args</span>] <span class="pl-c1">=</span> <span class="pl-en">f</span>(<span class="pl-c1">*</span><span class="pl-s1">args</span>)
        <span class="pl-k">return</span> <span class="pl-s1">cache_dict</span>[<span class="pl-s1">args</span>]
    <span class="pl-k">return</span> <span class="pl-s1">wrapper</span>


<span class="pl-en">@<span class="pl-s1">memoize</span>    <span class="pl-c"># 语法糖  对于一些其他语言，可以这样  fibo = memoize(fibo)</span></span>
<span class="pl-k">def</span> <span class="pl-en">fibo</span>(<span class="pl-s1">n</span>):
    <span class="pl-k">if</span> <span class="pl-s1">n</span> <span class="pl-c1">&lt;</span> <span class="pl-c1">2</span>:
        <span class="pl-k">return</span> <span class="pl-c1">1</span>
    <span class="pl-k">return</span> <span class="pl-en">fibo</span>(<span class="pl-s1">n</span><span class="pl-c1">-</span><span class="pl-c1">1</span>) <span class="pl-c1">+</span> <span class="pl-en">fibo</span>(<span class="pl-s1">n</span><span class="pl-c1">-</span><span class="pl-c1">2</span>)


<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-s1">t1</span> <span class="pl-c1">=</span> <span class="pl-s1">time</span>.<span class="pl-en">time</span>()
    <span class="pl-s1">ret</span> <span class="pl-c1">=</span> <span class="pl-en">fibo</span>(<span class="pl-c1">40</span>)
    <span class="pl-en">print</span>(<span class="pl-s">f"ret: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">ret</span><span class="pl-kos">}</span></span> use time: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">time</span>.<span class="pl-en">time</span>() <span class="pl-c1">-</span> <span class="pl-s1">t1</span><span class="pl-kos">}</span></span>"</span>)</pre></div>
<h3><a id="user-content-3-外观模式" class="anchor" aria-hidden="true" tabindex="-1" href="#3-外观模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 外观模式</h3>
<blockquote>
<p>外观设计模式有助于隐藏系统的内部复杂性，并通过一个简化的接口向客户端暴露必要的部分</p>
</blockquote>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/struct_facade.py</span>
<span class="pl-k">from</span> <span class="pl-s1">abc</span> <span class="pl-k">import</span> <span class="pl-v">ABCMeta</span>, <span class="pl-s1">abstractmethod</span>

<span class="pl-k">class</span> <span class="pl-v">Component</span>(<span class="pl-s1">metaclass</span><span class="pl-c1">=</span><span class="pl-v">ABCMeta</span>):
    <span class="pl-c"># 通用零部件</span>

    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">slef</span>):
        <span class="pl-c"># 初始化</span>
        <span class="pl-k">pass</span>

    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">boot</span>(<span class="pl-s1">self</span>):
        <span class="pl-c"># 启动</span>
        <span class="pl-k">pass</span>

    <span class="pl-en">@<span class="pl-s1">abstractmethod</span></span>
    <span class="pl-k">def</span> <span class="pl-en">stop</span>(<span class="pl-s1">self</span>):
        <span class="pl-c"># 停止</span>
        <span class="pl-k">pass</span>


<span class="pl-k">class</span> <span class="pl-v">Engine</span>(<span class="pl-v">Component</span>):

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"本田发动机"</span>

    <span class="pl-k">def</span> <span class="pl-en">boot</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> 启动中"</span>)

    <span class="pl-k">def</span> <span class="pl-en">stop</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> 已停止"</span>)
    

<span class="pl-k">class</span> <span class="pl-v">Electrical</span>(<span class="pl-v">Component</span>):

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"汽车电器件"</span>

    <span class="pl-k">def</span> <span class="pl-en">boot</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> 启动中"</span>)

    <span class="pl-k">def</span> <span class="pl-en">stop</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> 已停止"</span>)


<span class="pl-k">class</span> <span class="pl-v">Display</span>(<span class="pl-v">Component</span>):

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"汽车中控显示器"</span>

    <span class="pl-k">def</span> <span class="pl-en">boot</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> 启动中"</span>)

    <span class="pl-k">def</span> <span class="pl-en">stop</span>(<span class="pl-s1">self</span>):
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">self</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> 已停止"</span>)
    

<span class="pl-k">class</span> <span class="pl-v">UserOperator</span>:

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">engine</span> <span class="pl-c1">=</span> <span class="pl-v">Engine</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">electrical</span> <span class="pl-c1">=</span> <span class="pl-v">Electrical</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">display</span> <span class="pl-c1">=</span> <span class="pl-v">Display</span>()

    <span class="pl-k">def</span> <span class="pl-en">start</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">engine</span>.<span class="pl-en">boot</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">electrical</span>.<span class="pl-en">boot</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">display</span>.<span class="pl-en">boot</span>()
    
    <span class="pl-k">def</span> <span class="pl-en">stop</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">display</span>.<span class="pl-en">stop</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">electrical</span>.<span class="pl-en">stop</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">engine</span>.<span class="pl-en">stop</span>()
    
    <span class="pl-k">def</span> <span class="pl-en">stop_display</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">display</span>.<span class="pl-en">stop</span>()
    

<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-s1">op</span> <span class="pl-c1">=</span> <span class="pl-v">UserOperator</span>()
    <span class="pl-s1">op</span>.<span class="pl-en">start</span>()  <span class="pl-c"># 点火</span>
    <span class="pl-s1">op</span>.<span class="pl-en">stop_display</span>() <span class="pl-c"># 关闭中控显示器</span>
    <span class="pl-c"># 小车行驶.....</span>
    <span class="pl-s1">op</span>.<span class="pl-en">stop</span>() <span class="pl-c">#熄火</span></pre></div>
<h3><a id="user-content-4-享元模式" class="anchor" aria-hidden="true" tabindex="-1" href="#4-享元模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. 享元模式</h3>
<blockquote>
<p>享元就是一个包含状态独立的不可变（又称固有的）数据的共享对象 (关注的是共享对象数据)</p>
</blockquote>
<blockquote>
<p>若想要享元模式有效应该满足下面的条件：</p>
<p>应用需要使用大量的对象。</p>
<p>对象太多，存储/渲染它们的代价太大。一旦移除对象中的可变状态（因为在需要之时，应该由客户端代码显式地传递给享元），多组不同的对象可被相对更少的共享对象所替代。</p>
<p>对象ID对于应用不重要。对象共享会造成ID比较的失败，所以不能依赖对象ID（那些在客户端代码看来不同的对象，最终具有相同的ID）。</p>
</blockquote>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/struct_flyweight.py</span>
<span class="pl-k">from</span> <span class="pl-s1">abc</span> <span class="pl-k">import</span> <span class="pl-v">ABCMeta</span>

<span class="pl-k">class</span> <span class="pl-v">Car</span>(<span class="pl-s1">metaclass</span><span class="pl-c1">=</span><span class="pl-v">ABCMeta</span>):
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"car"</span>

<span class="pl-k">class</span> <span class="pl-v">MiniCar</span>(<span class="pl-v">Car</span>):
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"MiniCar"</span>

<span class="pl-k">class</span> <span class="pl-v">BusCar</span>(<span class="pl-v">Car</span>):
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"BusCar"</span>

<span class="pl-k">class</span> <span class="pl-v">BigCar</span>(<span class="pl-v">Car</span>):
    <span class="pl-s1">name</span> <span class="pl-c1">=</span> <span class="pl-s">"BigCar"</span>

<span class="pl-k">class</span> <span class="pl-v">CreateCar</span>:
    <span class="pl-s1">pool</span> <span class="pl-c1">=</span> <span class="pl-en">dict</span>()

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>, <span class="pl-s1">car</span>: <span class="pl-v">Car</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">car</span> <span class="pl-c1">=</span> <span class="pl-s1">car</span>

    <span class="pl-k">def</span> <span class="pl-en">__new__</span>(<span class="pl-s1">cls</span>, <span class="pl-s1">car</span>: <span class="pl-v">Car</span>, <span class="pl-c1">*</span><span class="pl-s1">args</span>, <span class="pl-c1">**</span><span class="pl-s1">kwargs</span>):
        <span class="pl-s1">_car</span> <span class="pl-c1">=</span> <span class="pl-s1">cls</span>.<span class="pl-s1">pool</span>.<span class="pl-en">get</span>(<span class="pl-s1">car</span>.<span class="pl-s1">name</span>)
        <span class="pl-k">if</span> <span class="pl-c1">not</span> <span class="pl-s1">_car</span>:
            <span class="pl-s1">_car</span> <span class="pl-c1">=</span> <span class="pl-s1">object</span>.<span class="pl-en">__new__</span>(<span class="pl-s1">cls</span>)
            <span class="pl-s1">cls</span>.<span class="pl-s1">pool</span>[<span class="pl-s1">car</span>.<span class="pl-s1">name</span>] <span class="pl-c1">=</span> <span class="pl-s1">_car</span>
        <span class="pl-k">return</span> <span class="pl-s1">_car</span>
    
    <span class="pl-k">def</span> <span class="pl-en">numberid</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-en">id</span>(<span class="pl-s1">self</span>.<span class="pl-s1">car</span>)

<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-s1">mini_car</span> <span class="pl-c1">=</span> <span class="pl-v">MiniCar</span>()
    <span class="pl-s1">bus_car</span> <span class="pl-c1">=</span> <span class="pl-v">BusCar</span>()
    <span class="pl-s1">big_car</span> <span class="pl-c1">=</span> <span class="pl-v">BigCar</span>()
    <span class="pl-c"># 对象已创建，即使不停创建的实例，都是基于此对象进行创建</span>
    <span class="pl-k">for</span> <span class="pl-s1">_</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>):
        <span class="pl-s1">c1</span> <span class="pl-c1">=</span> <span class="pl-v">CreateCar</span>(<span class="pl-s1">mini_car</span>)
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c1</span>.<span class="pl-s1">car</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> car id <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c1</span>.<span class="pl-en">numberid</span>()<span class="pl-kos">}</span></span>"</span>)
    <span class="pl-k">for</span> <span class="pl-s1">_</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>):
        <span class="pl-s1">c2</span> <span class="pl-c1">=</span> <span class="pl-v">CreateCar</span>(<span class="pl-s1">bus_car</span>)
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c2</span>.<span class="pl-s1">car</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> car id <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c2</span>.<span class="pl-en">numberid</span>()<span class="pl-kos">}</span></span>"</span>)
    <span class="pl-k">for</span> <span class="pl-s1">_</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>):
        <span class="pl-s1">c3</span> <span class="pl-c1">=</span> <span class="pl-v">CreateCar</span>(<span class="pl-s1">big_car</span>)
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c3</span>.<span class="pl-s1">car</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> car id <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c3</span>.<span class="pl-en">numberid</span>()<span class="pl-kos">}</span></span>"</span>)
    <span class="pl-k">for</span> <span class="pl-s1">_</span> <span class="pl-c1">in</span> <span class="pl-en">range</span>(<span class="pl-c1">10</span>):
        <span class="pl-s1">c4</span> <span class="pl-c1">=</span> <span class="pl-v">CreateCar</span>(<span class="pl-s1">mini_car</span>)
        <span class="pl-en">print</span>(<span class="pl-s">f"<span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c4</span>.<span class="pl-s1">car</span>.<span class="pl-s1">name</span><span class="pl-kos">}</span></span> car id <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">c4</span>.<span class="pl-en">numberid</span>()<span class="pl-kos">}</span></span>"</span>)</pre></div>
<h3><a id="user-content-5-模型-视图-控制器模式" class="anchor" aria-hidden="true" tabindex="-1" href="#5-模型-视图-控制器模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>5. 模型-视图-控制器模式</h3>
<blockquote>
<p>模型是核心的部分，代表着应用的信息本源，包含和管理（业务）逻辑、数据、状态以及应用的规则。</p>
<p>视图是模型的可视化表现。视图的例子有，计算机图形用户界面、计算机终端的文本输出、智能手机的应用图形界面、PDF文档、饼图和柱状图等。视图只是展示数据，并不处理数据。</p>
<p>控制器是模型与视图之间的链接/粘附。模型与视图之间的所有通信都通过控制器进行。</p>
</blockquote>
<div class="highlight highlight-source-python"><pre><span class="pl-c"># DesignDocs/src/struct_mvc.py</span>
<span class="pl-k">class</span> <span class="pl-v">Model</span>:

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">data</span> <span class="pl-c1">=</span> []

    <span class="pl-k">def</span> <span class="pl-en">get</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">return</span> <span class="pl-s1">self</span>.<span class="pl-s1">data</span>
    
    <span class="pl-k">def</span> <span class="pl-en">add</span>(<span class="pl-s1">self</span>, <span class="pl-s1">data</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">data</span>.<span class="pl-en">append</span>(<span class="pl-s1">data</span>)
        <span class="pl-k">return</span> <span class="pl-s1">self</span>.<span class="pl-s1">data</span>

<span class="pl-k">class</span> <span class="pl-v">View</span>:

    <span class="pl-k">def</span> <span class="pl-en">show</span>(<span class="pl-s1">self</span>, <span class="pl-s1">data</span>):
        <span class="pl-k">for</span> <span class="pl-s1">i</span> <span class="pl-c1">in</span> <span class="pl-s1">data</span>:
            <span class="pl-en">print</span>(<span class="pl-s">f"view: <span class="pl-s1"><span class="pl-kos">{</span><span class="pl-s1">i</span><span class="pl-kos">}</span></span>"</span>)

<span class="pl-k">class</span> <span class="pl-v">Controller</span>:

    <span class="pl-k">def</span> <span class="pl-en">__init__</span>(<span class="pl-s1">self</span>):
        <span class="pl-s1">self</span>.<span class="pl-s1">model</span> <span class="pl-c1">=</span> <span class="pl-v">Model</span>()
        <span class="pl-s1">self</span>.<span class="pl-s1">view</span> <span class="pl-c1">=</span> <span class="pl-v">View</span>()

    <span class="pl-k">def</span> <span class="pl-en">run</span>(<span class="pl-s1">self</span>):
        <span class="pl-k">while</span> <span class="pl-c1">True</span>:
            <span class="pl-s1">i</span> <span class="pl-c1">=</span> <span class="pl-en">input</span>(<span class="pl-s">"please input to view! input q exit:<span class="pl-cce">\n</span>"</span>)
            <span class="pl-s1">i</span> <span class="pl-c1">=</span> <span class="pl-s1">i</span>.<span class="pl-en">rstrip</span>(<span class="pl-s">"<span class="pl-cce">\n</span>"</span>)
            <span class="pl-k">if</span> <span class="pl-s1">i</span> <span class="pl-c1">==</span> <span class="pl-s">"q"</span>:
                <span class="pl-k">break</span>
            <span class="pl-s1">self</span>.<span class="pl-s1">model</span>.<span class="pl-en">add</span>(<span class="pl-s1">i</span>)
            <span class="pl-s1">data</span> <span class="pl-c1">=</span> <span class="pl-s1">self</span>.<span class="pl-s1">model</span>.<span class="pl-en">get</span>()
            <span class="pl-s1">self</span>.<span class="pl-s1">view</span>.<span class="pl-en">show</span>(<span class="pl-s1">data</span>)


<span class="pl-k">if</span> <span class="pl-s1">__name__</span> <span class="pl-c1">==</span> <span class="pl-s">"__main__"</span>:
    <span class="pl-s1">c</span> <span class="pl-c1">=</span> <span class="pl-v">Controller</span>()
    <span class="pl-s1">c</span>.<span class="pl-en">run</span>()</pre></div>
<h3><a id="user-content-6-代理模式" class="anchor" aria-hidden="true" tabindex="-1" href="#6-代理模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>6. 代理模式</h3>
<blockquote>
<p>四种不同的知名代理类型</p>
<p>远程代理：实际存在于不同地址空间（例如，某个网络服务器）的对象在本地的代理者。</p>
<p>虚拟代理：用于懒初始化，将一个大计算量对象的创建延迟到真正需要的时候进行。</p>
<p>保护/防护代理：控制对敏感对象的访问。</p>
<p>智能（引用）代理：在对象被访问时执行额外的动作。此类代理的例子包括引用计数和线程安全检查。</p>
</blockquote>
<h2><a id="user-content-三行为型模式-介绍对象之间通信的关系" class="anchor" aria-hidden="true" tabindex="-1" href="#三行为型模式-介绍对象之间通信的关系"><span aria-hidden="true" class="octicon octicon-link"></span></a>三、行为型模式-&gt;介绍对象之间通信的关系</h2>
<h3><a id="user-content-1-责任链模式" class="anchor" aria-hidden="true" tabindex="-1" href="#1-责任链模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 责任链模式</h3>
<blockquote>
<p>责任链（Chain of Responsibility）模式用于让多个对象来处理单个请求时，或者用于预先不知道应该由哪个对象（来自某个对象链）来处理某个特定请求时。其原则如下所示。</p>
<p>(1) 存在一个对象链（链表、树或任何其他便捷的数据结构）。</p>
<p>(2) 我们一开始将请求发送给链中的第一个对象。</p>
<p>(3) 对象决定其是否要处理该请求。</p>
<p>(4) 对象将请求转发给下一个对象。</p>
<p>(5) 重复该过程，直到到达链尾。</p>
</blockquote>
<h3><a id="user-content-2-命令模式" class="anchor" aria-hidden="true" tabindex="-1" href="#2-命令模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 命令模式</h3>
<h3><a id="user-content-3-解释器模式" class="anchor" aria-hidden="true" tabindex="-1" href="#3-解释器模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 解释器模式</h3>
<h3><a id="user-content-4-观察者模式" class="anchor" aria-hidden="true" tabindex="-1" href="#4-观察者模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. 观察者模式</h3>
<h3><a id="user-content-5-状态模式" class="anchor" aria-hidden="true" tabindex="-1" href="#5-状态模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>5. 状态模式</h3>
<h3><a id="user-content-6-策略模式" class="anchor" aria-hidden="true" tabindex="-1" href="#6-策略模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>6. 策略模式</h3>
<h3><a id="user-content-7-模板模式" class="anchor" aria-hidden="true" tabindex="-1" href="#7-模板模式"><span aria-hidden="true" class="octicon octicon-link"></span></a>7. 模板模式</h3>

      </article>
    </div>
  </div>
  <div class="
    side
    Box
    md
    js-code-block-container
    Box--responsive
    container-right-nav
    mt-5
    d-none d-lg-block
  " style="overflow: hidden;">
    <div class="Box-body p-5">
      <div class="container-right-nav-logo">
        <a href="https://www.github.com/Bean-jun"><svg height="32" class="octicon octicon-mark-github anim-pulse"
            viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true">
            <path fill-rule="evenodd"
              d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z">
            </path>
          </svg></a>
      </div>
    </div>
    <div class="content-title-nav">
      <ul>
        <li><a href="#零、面向对象设计原则">零、面向对象设计原则</a></li><li><a href="#一、创建型模式->介绍对象创建">一、创建型模式->介绍对象创建</a></li><li><a href="#二、结构型模式->介绍不同对象之间的关系">二、结构型模式->介绍不同对象之间的关系</a></li><li><a href="#三、行为型模式->介绍对象之间通信的关系">三、行为型模式->介绍对象之间通信的关系</a></li>
      </ul>
    </div>
  </div>
  <script src="/.static/js/theme.js"></script>
  <script src="/.static/js/iconify.min.js"></script>
</body>

</html>